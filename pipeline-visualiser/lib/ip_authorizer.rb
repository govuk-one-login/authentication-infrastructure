require 'ipaddr'

class IPAuthorizer
  VALID_IPS = [
    '217.196.229.77/32',
    '217.196.229.79/32',
    '217.196.229.80/31',
    '51.149.8.0/25',
    '51.149.8.128/29',
    '213.86.153.211/32',
    '213.86.153.212/31',
    '213.86.153.214/32',
    '213.86.153.235/32',
    '213.86.153.236/31',
    '213.86.153.231/32',
    '3.9.227.33/32',
    '18.132.149.145/32',
    '51.142.180.30/32',
    '185.120.72.241/32',
    '185.120.72.242/31',
    '3.9.56.99/32',
    '35.176.92.32/29',
    '18.169.230.200/29',
    '10.6.0.0/16'
  ].freeze

  def self.authorized?(ip_address)
    return true if ENV['RACK_ENV'] == 'local'

    VALID_IPS.any? do |cidr|
      IPAddr.new(cidr).include?(ip_address)
    end
  end
end
